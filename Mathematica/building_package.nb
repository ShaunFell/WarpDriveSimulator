(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     62105,       1474]
NotebookOptionsPosition[     61533,       1457]
NotebookOutlinePosition[     61954,       1474]
CellTagsIndexPosition[     61911,       1471]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"===", 
   RowBox[{
   "WARP", " ", "DRIVE", " ", "SPACETIME", " ", "ANALYSIS", " ", "WITH", " ", 
    "WOLFRAM", " ", "FUNCTION", " ", "ARCHIVE"}], "==="}], "*)"}]], "Input",
 CellChangeTimes->{{3.964910407998023*^9, 
  3.964910453029188*^9}},ExpressionUUID->"f9621b7f-6184-4bda-81b5-\
d883d9e89c5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@@", 
   RowBox[{"Names", "[", "\"\<Global`*\>\"", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "===", "===", "==="}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Environment", " ", "variables"}], "===", "===", "===", "===", "===",
       "===", "===", "==="}], "="}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$TooltipTreeThreshold", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$GeodesicNumericalPrecision", "=", "$MachinePrecision"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$GeodesicNumericalAccuracy", " ", "=", " ", "$MachinePrecision"}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "===", "===", "==="}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Utility", " ", "functions"}], "===", "===", "===", "===", "===",
       "===", "===", "==="}], "="}]}], "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SmartDisplay", "[", "expr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LeafCount", "[", "expr", "]"}], ">", "$TooltipTreeThreshold"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Show", " ", "as", " ", "tooltip", " ", "if", " ", "too", " ", 
       "large"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Tooltip", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Framed", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"\"\<[\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"LeafCount", "[", "expr", "]"}], "]"}], 
            "<>", "\"\<]\>\""}], ",", "Italic", ",", "10", ",", "Blue"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Background", "->", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.97", ",", "0.97", ",", "1"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameStyle", "->", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.7", ",", "0.7", ",", "0.9"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RoundingRadius", "->", "10"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameMargins", "->", "3"}]}], "\[IndentingNewLine]", "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Framed", "[", 
        RowBox[{
         RowBox[{"Defer", "[", "expr", "]"}], ",", 
         RowBox[{"Background", "->", "White"}], ",", 
         RowBox[{"FrameStyle", "->", "LightGray"}], ",", 
         RowBox[{"ImageSize", "->", "500"}], ",", 
         RowBox[{"Scrollbars", "->", "True"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Show", " ", "normally", " ", "if", " ", "small"}], "*)"}], 
     "\[IndentingNewLine]", "expr"}], " ", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "===", "===", "==="}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Spacetime", " ", "Objects"}], "===", "===", "===", "===", "===",
       "===", "===", "==="}], "="}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Metric", " ", "tensor", " ", "object", " ", "to", " ", "hold", " ", 
    "objects", " ", "related", " ", "to", " ", "the", " ", "Metric", " ", 
    "tensor"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MetricTensor", "[", 
   RowBox[{"matrix_", ",", "coords_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", " ", "=", " ", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<MetricTensor\>\"", "]"}], "[", 
       RowBox[{"matrix", ",", "coords", ",", "True", ",", "True"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"MetricTensorObject", "[", 
      RowBox[{"result", ",", " ", "matrix", ",", " ", "coords"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MetricTensorObject", "[", 
    RowBox[{"result_", ",", " ", "_", ",", " ", "_"}], "]"}], 
   "[", "\"\<Matrix\>\"", "]"}], ":=", 
  RowBox[{"result", "[", "\"\<MatrixRepresentation\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MetricTensorObject", "[", 
    RowBox[{"result_", ",", "_", ",", "coords_"}], "]"}], 
   "[", "\"\<Coordinates\>\"", "]"}], ":=", 
  RowBox[{"result", "[", "\"\<Coordinates\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MetricTensorObject", "[", 
    RowBox[{"result_", ",", " ", "_", ",", " ", "_"}], "]"}], 
   "[", "\"\<Object\>\"", "]"}], ":=", "result"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MetricTensorObject", "[", 
    RowBox[{"_", ",", "_", ",", "_"}], "]"}], "[", "key_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"MetricTensor", "::", "prop"}], ",", " ", "key"}], "]"}], ";", 
    " ", "$Failed"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MetricTensor", "::", "prop"}], " ", "=", 
    " ", "\"\<Property `1` is not known.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MetricTensorObject", "/:", 
   RowBox[{"Format", "[", 
    RowBox[{"MetricTensorObject", "[", 
     RowBox[{"res_", ",", "mat_", ",", "coords_"}], "]"}], "]"}], ":=", 
   RowBox[{"DisplayForm", "@", 
    RowBox[{"Panel", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SubscriptBox", "[", 
          RowBox[{"\"\<g\>\"", ",", " ", 
           RowBox[{"ToBoxes", "[", "\"\<\[Mu]\[Nu]\>\"", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ToBoxes", "[", "\"\<(\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Riffle", "[", 
           RowBox[{"coords", ",", " ", "\"\<,\>\""}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ToBoxes", "[", "\"\<)\>\"", "]"}]}], "\[IndentingNewLine]", 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Background", "->", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.96", ",", "0.96", ",", "1", ",", ".2"}], "]"}]}], ",", 
      RowBox[{"ImageMargins", "->", "0"}], ",", 
      RowBox[{"FrameMargins", "->", "3"}], ",", 
      RowBox[{"LabelStyle", "->", 
       RowBox[{"{", 
        RowBox[{"Bold", ",", "12"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Christoffel", " ", "object", " ", "to", " ", "hold", " ", "objects", " ", 
    "related", " ", "to", " ", "Christoffel", " ", "symbols"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Christoffel", "[", "metric_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"result", " ", "=", " ", 
      RowBox[{
       RowBox[{"ResourceFunction", "[", "\"\<ChristoffelSymbols\>\"", "]"}], "[", 
       RowBox[{"metric", "[", "\"\<Object\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ChristoffelObject", "[", 
      RowBox[{"result", ",", "metric"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChristoffelObject", "[", 
    RowBox[{"res_", ",", "_"}], "]"}], "[", "\"\<Matrix\>\"", "]"}], ":=", 
  RowBox[{"res", "[", "\"\<TensorRepresentation\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChristoffelObject", "[", 
    RowBox[{"res_", ",", "_"}], "]"}], "[", "\"\<Coordinates\>\"", "]"}], ":=", 
  RowBox[{"res", "[", "\"\<Coordinates\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChristoffelObject", "[", 
    RowBox[{"res_", ",", "_"}], "]"}], "[", "\"\<Object\>\"", "]"}], ":=", 
  "res"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChristoffelObject", "[", 
    RowBox[{"_", ",", "_"}], "]"}], "[", "key_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"Christoffel", "::", "prop"}], ",", " ", "key"}], "]"}], ";", 
    " ", "$Failed"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Christoffel", "::", "prop"}], " ", "=", 
   " ", "\"\<Property `1` is not known.\>\""}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"ChristoffelObject", "/:", 
   RowBox[{"Format", "[", 
    RowBox[{"ChristoffelObject", "[", 
     RowBox[{"result_", ",", " ", "metric_"}], "]"}], "]"}], ":=", 
   RowBox[{"DisplayForm", "@", 
    RowBox[{"Panel", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SubscriptBox", "[", 
          RowBox[{
           RowBox[{"SuperscriptBox", "[", 
            RowBox[{"\"\<\[CapitalGamma]\>\"", ",", " ", 
             RowBox[{"ToBoxes", "[", "\"\<\[Alpha]\>\"", "]"}]}], "]"}], ",", 
           " ", 
           RowBox[{"ToBoxes", "[", "\"\<\[Mu]\[Nu]\>\"", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ToBoxes", "[", "\"\<(\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"metric", "[", "\"\<Coordinates\>\"", "]"}], ",", 
            " ", "\"\<,\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ToBoxes", "[", "\"\<)\>\"", "]"}]}], "\[IndentingNewLine]", 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Background", "->", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.96", ",", "0.96", ",", "1", ",", ".2"}], "]"}]}], ",", 
      RowBox[{"ImageMargins", "->", "0"}], ",", 
      RowBox[{"FrameMargins", "->", "3"}], ",", 
      RowBox[{"LabelStyle", "->", 
       RowBox[{"{", 
        RowBox[{"Bold", ",", "12"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Spacetime", " ", "object", " ", "to", " ", "hold", " ", "fundamental", " ",
     "objects", " ", "associated", " ", "to", " ", "a", " ", "spacetime"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Spacetime", "[", 
   RowBox[{"matrix_", ",", " ", "coords_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"met", ",", " ", "chris"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"met", " ", "=", " ", 
      RowBox[{"MetricTensor", "[", 
       RowBox[{"matrix", ",", " ", "coords"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"chris", " ", "=", " ", 
      RowBox[{"Christoffel", "[", "met", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"SpacetimeObject", "[", 
      RowBox[{
      "matrix", ",", " ", "coords", ",", " ", "met", ",", " ", "chris"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Spacetime", "[", "metric_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"matrix", ",", " ", "coords", ",", "chris"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"matrix", " ", "=", " ", 
      RowBox[{"metric", "[", "\"\<Matrix\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coords", " ", "=", " ", 
      RowBox[{"metric", "[", "\"\<Coordinates\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"chris", " ", "=", " ", 
      RowBox[{"Christoffel", "[", "metric", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SpacetimeObject", "[", 
      RowBox[{
      "matrix", ",", " ", "coords", ",", " ", "metric", ",", " ", "chris"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpacetimeObject", "[", 
     RowBox[{"mat_", ",", " ", "_", ",", " ", "_", ",", " ", "_"}], "]"}], 
    "[", "\"\<Matrix\>\"", "]"}], ":=", "mat"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpacetimeObject", "[", 
     RowBox[{"_", ",", " ", "coords_", ",", " ", "_", ",", " ", "_"}], "]"}], 
    "[", "\"\<Coordinates\>\"", "]"}], ":=", "coords"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpacetimeObject", "[", 
     RowBox[{"_", ",", "_", ",", "met_", ",", "_"}], "]"}], 
    "[", "\"\<Metric\>\"", "]"}], ":=", "met"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpacetimeObject", "[", 
    RowBox[{"_", ",", "_", ",", "_", ",", "chris_"}], "]"}], 
   "[", "\"\<Christoffel\>\"", "]"}], ":=", 
  "chris"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpacetimeObject", "[", 
    RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "]"}], "[", "key_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"Spacetime", "::", "prop"}], ",", " ", "key"}], "]"}], ";", " ",
     "$Failed"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Spacetime", "::", "prop"}], " ", "=", 
    " ", "\"\<Property `1` is not known.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SpacetimeObject", "/:", 
   RowBox[{"Format", "[", 
    RowBox[{"SpacetimeObject", "[", 
     RowBox[{"mat_", ",", "coords_", ",", "met_", ",", "chris_"}], "]"}], 
    "]"}], ":=", 
   RowBox[{"DisplayForm", "@", 
    RowBox[{"Panel", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RowBox", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToBoxes", "[", "\"\<\[ScriptCapitalM]\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ToBoxes", "[", "\"\<[\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"SubscriptBox", "[", 
          RowBox[{"\"\<g\>\"", ",", " ", 
           RowBox[{"ToBoxes", "[", "\"\<\[Mu]\[Nu]\>\"", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ToBoxes", "[", "\"\<,\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"SubscriptBox", "[", 
          RowBox[{
           RowBox[{"SuperscriptBox", "[", 
            RowBox[{"\"\<\[CapitalGamma]\>\"", ",", " ", 
             RowBox[{"ToBoxes", "[", "\"\<\[Alpha]\>\"", "]"}]}], "]"}], ",", 
           " ", 
           RowBox[{"ToBoxes", "[", "\"\<\[Mu]\[Nu]\>\"", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ToBoxes", "[", "\"\<]\>\"", "]"}]}], "\[IndentingNewLine]", 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Background", "->", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"0.96", ",", "0.96", ",", "1", ",", ".2"}], "]"}]}], ",", 
      RowBox[{"ImageMargins", "->", "0"}], ",", 
      RowBox[{"FrameMargins", "->", "3"}], ",", 
      RowBox[{"LabelStyle", "->", 
       RowBox[{"{", 
        RowBox[{"Bold", ",", "12"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Utility", " ", "function", " ", "to", " ", "analysis", " ", "objects", " ",
     "within", " ", "a", " ", "SpacetimeObject"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpacetimeInfo", "[", "st_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"metricMatrix", " ", "=", " ", 
        RowBox[{"st", "[", "\"\<Matrix\>\"", "]"}]}], ",", " ", 
       RowBox[{"chrisMatrix", " ", "=", " ", 
        RowBox[{
         RowBox[{"st", "[", "\"\<Christoffel\>\"", "]"}], 
         "[", "\"\<Matrix\>\"", "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Framed", "[", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"#1", ",", "Bold", ",", 
                 RowBox[{"Darker", "@", "Blue"}]}], "]"}], 
               ",", "\"\< \[RightArrow] \>\"", ",", "#2"}], "}"}], "]"}], ",", 
            RowBox[{"Background", "->", "White"}], ",", 
            RowBox[{"FrameStyle", "->", "LightGray"}], ",", 
            RowBox[{"RoundingRadius", "->", "5"}], ",", 
            RowBox[{"FrameMargins", "->", "8"}]}], "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<MetricMatrix\>\"", "->", 
            RowBox[{"Map", "[", 
             RowBox[{"SmartDisplay", ",", "metricMatrix", ",", " ", 
              RowBox[{"{", 
               RowBox[{"ArrayDepth", "[", "metricMatrix", "]"}], "}"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<ChristoffelMatrix\>\"", "->", 
            RowBox[{"Map", "[", 
             RowBox[{"SmartDisplay", ",", "chrisMatrix", ",", " ", 
              RowBox[{"{", 
               RowBox[{"ArrayDepth", "[", "chrisMatrix", "]"}], "}"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<Coordinates\>\"", "->", 
            RowBox[{"SmartDisplay", "@", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"st", "[", "\"\<Coordinates\>\"", "]"}], "]"}]}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<MetricObject\>\"", "->", 
            RowBox[{"st", "[", "\"\<Metric\>\"", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<ChristoffelObject\>\"", "->", 
            RowBox[{"st", "[", "\"\<Christoffel\>\"", "]"}]}]}], 
          "\[IndentingNewLine]", "|>"}]}], "\[IndentingNewLine]", "]"}], ",", 
       
       RowBox[{"Spacings", "->", "0.5"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "===", "===", "==="}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Common", " ", "Spacetime", " ", "Objects"}], "===", "===", "===",
       "===", "===", "===", "===", "==="}], "="}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MinkowskiMetric", "[", "]"}], ":=", 
  RowBox[{"MetricTensor", "[", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MinkowskiSpacetime", "[", "]"}], ":=", 
   RowBox[{"Spacetime", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1", ",", "1", ",", "1"}], "}"}], "]"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WarpFunction", "[", 
    RowBox[{"rs_", ",", " ", "R_", ",", " ", 
     RowBox[{"\[Sigma]_", ":", "1"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Tanh", "[", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"rs", "+", "R"}], ")"}], "\[Sigma]"], "]"}], "-", 
      RowBox[{"Tanh", "[", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"rs", "-", "R"}], ")"}], "\[Sigma]"], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", "*", 
      RowBox[{"Tanh", "[", 
       RowBox[{"R", "/", "\[Sigma]"}], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AlcubierreShift", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Velocity", "->", "0.8"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BubbleRadius", "->", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BubbleThickness", "->", "10"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlcubierreShift", "[", 
    RowBox[{"t_", ",", "x_", ",", "y_", ",", "z_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rs", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rs", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Velocity", "]"}], "*", "t"}]}], 
           ")"}], "2"], " ", "+", " ", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xshift", " ", "=", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"OptionValue", "[", "Velocity", "]"}]}], "*", " ", 
        RowBox[{"WarpFunction", "[", 
         RowBox[{"rs", ",", " ", 
          RowBox[{"OptionValue", "[", "BubbleRadius", "]"}], ",", " ", 
          RowBox[{"OptionValue", "[", "BubbleThickness", "]"}]}], "]"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"yshift", " ", "=", " ", "0."}], ";", "\[IndentingNewLine]", 
      RowBox[{"zshift", " ", "=", " ", "0."}], ";", "\[IndentingNewLine]", 
      RowBox[{"shiftvector", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"xshift", ",", " ", "yshift", ",", " ", "zshift"}], "}"}]}], ";",
       "\[IndentingNewLine]", "shiftvector"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AlcubierreMetric", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Velocity", "->", "0.8"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BubbleRadius", "->", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BubbleThickness", "->", "10"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlcubierreMetric", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"shift", " ", "=", " ", 
        RowBox[{"AlcubierreShift", "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z", ",", " ", 
          RowBox[{"Velocity", "->", 
           RowBox[{"OptionValue", "[", "Velocity", "]"}]}], ",", " ", 
          RowBox[{"BubbleRadius", "->", 
           RowBox[{"OptionValue", "[", "BubbleRadius", "]"}]}], ",", " ", 
          RowBox[{"BubbleThickness", "->", 
           RowBox[{"OptionValue", "[", "BubbleThickness", "]"}]}]}], "]"}]}], 
       ",", " ", "matrix", ",", " ", "coords"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coords", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"matrix", " ", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], " ", "+", " ", 
            RowBox[{"Dot", "[", 
             RowBox[{"shift", ",", " ", "shift"}], "]"}]}], ",", " ", 
           RowBox[{"Sequence", "@@", "shift"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Transpose", "@", 
             RowBox[{"{", 
              RowBox[{"shift", ",", " ", 
               RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"MetricTensor", "[", 
       RowBox[{"matrix", ",", " ", "coords"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AlcubierreSpacetime", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Velocity", "->", "0.8"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BubbleRadius", "->", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BubbleThickness", "->", "10"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AlcubierreSpacetime", "[", 
   RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"AlcubierreMetric", "[", " ", 
       RowBox[{
        RowBox[{"Velocity", "->", 
         RowBox[{"OptionValue", "[", "Velocity", "]"}]}], ",", " ", 
        RowBox[{"BubbleRadius", "->", 
         RowBox[{"OptionValue", "[", "BubbleRadius", "]"}]}], ",", " ", 
        RowBox[{"BubbleThickness", "->", 
         RowBox[{"OptionValue", "[", "BubbleThickness", "]"}]}]}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Spacetime", "[", "metric", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.964910493123908*^9, 3.96491049476652*^9}, {
   3.964910616991487*^9, 3.964910768193701*^9}, {3.964910927652616*^9, 
   3.964910935877142*^9}, {3.964911010283107*^9, 3.964911025104538*^9}, {
   3.9649111249945173`*^9, 3.964911126519382*^9}, {3.964911457350142*^9, 
   3.9649114737307043`*^9}, {3.9649115331574907`*^9, 3.964911681282174*^9}, {
   3.964911731177994*^9, 3.964911738169249*^9}, 3.9649118234847527`*^9, {
   3.964911901956389*^9, 3.964911904899629*^9}, 3.964912003650199*^9, {
   3.9649122258436613`*^9, 3.964912368002952*^9}, {3.964912412153191*^9, 
   3.964912504376492*^9}, {3.964912558134575*^9, 3.964912572529882*^9}, {
   3.9649126164485083`*^9, 3.964912627955018*^9}, {3.964914621240142*^9, 
   3.9649146661002493`*^9}, {3.964914707282137*^9, 3.9649147232950773`*^9}, {
   3.964914831166521*^9, 3.9649148679753933`*^9}, 3.964914928777779*^9, {
   3.964914990724283*^9, 3.964915016437648*^9}, {3.964953947865039*^9, 
   3.964954280896079*^9}, {3.964954528124703*^9, 3.9649545488922157`*^9}, {
   3.96495470714242*^9, 3.964954739212435*^9}, {3.964954823766858*^9, 
   3.964955001096011*^9}, {3.9649550345024*^9, 3.964955113346326*^9}, {
   3.964955143747151*^9, 3.964955178638575*^9}, {3.964955214970605*^9, 
   3.964955267728565*^9}, {3.964955318397861*^9, 3.964955415269702*^9}, {
   3.964955488354141*^9, 3.964955644632708*^9}, {3.964955768463307*^9, 
   3.9649557796198673`*^9}, {3.964955877303761*^9, 3.964955879229313*^9}, {
   3.964955921517684*^9, 3.964955922890439*^9}, {3.964956071848782*^9, 
   3.964956089758762*^9}, {3.9649561824711933`*^9, 3.9649564853176527`*^9}, {
   3.964956536756372*^9, 3.964956566788991*^9}, {3.964956637449394*^9, 
   3.964956747033471*^9}, {3.9649568276591463`*^9, 3.9649568901668043`*^9}, {
   3.9649569877410593`*^9, 3.964957007097444*^9}, {3.9649570371334*^9, 
   3.9649572412530327`*^9}, {3.964957339395543*^9, 3.964957431941575*^9}, {
   3.964957481687418*^9, 3.964957492147788*^9}, {3.964957597580147*^9, 
   3.96495759997196*^9}, {3.9649576416156473`*^9, 3.96495765177276*^9}, 
   3.964957827054468*^9, {3.964957858614689*^9, 3.9649579849453278`*^9}, {
   3.964958204959914*^9, 3.9649582940490503`*^9}, {3.964959070352936*^9, 
   3.96495918374459*^9}, {3.964959221906144*^9, 3.964959240972269*^9}, {
   3.964959315954051*^9, 3.9649594279879932`*^9}, {3.964959465024247*^9, 
   3.964959579234907*^9}, {3.964959637922885*^9, 3.964959640523573*^9}, {
   3.964959862147367*^9, 3.964959951395241*^9}, {3.9649601863895683`*^9, 
   3.9649603094591103`*^9}, {3.964960352345915*^9, 3.964960453244594*^9}, {
   3.96499226288008*^9, 3.9649922894447937`*^9}},
 CellLabel->
  "In[1327]:=",ExpressionUUID->"46cb78d0-645c-41ba-9671-f0357470e829"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"===", "===", "===", "===", "===", "===", "===", "==="}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Geodesic", " ", "Integration", " ", "Methods"}], "===", "===", 
      "===", "===", "===", "===", "===", "==="}], "="}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Store", " ", "the", " ", "Null", " ", "geodesic", " ", "integrator", " ", 
    "on", " ", "the", " ", "SpacetimeObject"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "TraceNullGeodesic", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<MaxAffineParameter\>\"", "->", "100"}], ",", " ", 
       RowBox[{"\"\<StepSize\>\"", "->", "0.01"}], ",", " ", 
       RowBox[{"\"\<Method\>\"", "->", "\"\<AdaptiveRungeKutta\>\""}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SpacetimeObject", "/:", 
     RowBox[{"TraceNullGeodesic", "[", 
      RowBox[{
      "spacetime_SpacetimeObject", ",", " ", "initialPos_List", ",", " ", 
       "initialDir_List", ",", " ", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "metric", ",", " ", "christoffel", ",", " ", "coords", ",", " ", 
         "geodesicSystem", ",", " ", "affineRange", ",", " ", "solution", ",",
          " ", "normalizedDir", ",", " ", "\[Lambda]Max", ",", " ", 
         "stepSize", ",", " ", "method"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{"Extreact", " ", "spacetime", " ", "objects"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"metric", " ", "=", " ", 
         RowBox[{
          RowBox[{"spacetime", "[", "\"\<Metric\>\"", "]"}], 
          "[", "\"\<Matrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"christoffel", " ", "=", " ", 
         RowBox[{
          RowBox[{"spacetime", "[", "\"\<Christoffel\>\"", "]"}], 
          "[", "\"\<Matrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coords", " ", "=", " ", 
         RowBox[{"spacetime", "[", "\"\<Coordinates\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", "Options", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Lambda]Max", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<MaxAffineParameter\>\"", "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"stepSize", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<StepSize\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"method", " ", "=", " ", 
         RowBox[{"OptionValue", "[", "\"\<Method\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Normalize", " ", "initial", " ", "direction", " ", "to", " ", 
          "satisfy", " ", "null", " ", "condition"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"normalizedDir", " ", "=", " ", 
         RowBox[{"NormalizeNullDirection", "[", 
          RowBox[{
          "spacetime", ",", " ", "initialPos", ",", " ", "initialDir"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Setup", " ", "the", " ", "geodesic", " ", "equation", " ", 
          "system"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"geodesicSystem", " ", "=", " ", 
         RowBox[{"BuildGeodesicSystem", "[", 
          RowBox[{
          "spacetime", ",", " ", "coords", ",", " ", "initialPos", ",", " ", 
           "normalizedDir"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Integrate", " ", "using", " ", "NDSolve"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"solution", " ", "=", " ", 
         RowBox[{"NDSolve", "[", 
          RowBox[{"geodesicSystem", ",", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"coords", ",", " ", 
              RowBox[{"Through", "[", 
               RowBox[{
                SuperscriptBox["coords", "\[Prime]"], "[", "\[Lambda]", "]"}],
                "]"}]}], "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Lambda]", ",", "0", ",", "\[Lambda]Max"}], "}"}], ",", 
           " ", 
           RowBox[{"Method", "->", "method"}], ",", " ", 
           RowBox[{"MaxSteps", "->", 
            RowBox[{"\[Lambda]Max", "/", "stepSize"}]}], ",", " ", 
           RowBox[{"PrecisionGoal", "->", "$GeodesicNumericalPrecision"}], ",",
            " ", 
           RowBox[{"AccuracyGoal", "->", "$GeodesicNumericalAccuracy"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"GeodesicSolution", "[", 
         RowBox[{
          RowBox[{"solution", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", "coords", ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[Lambda]Max"}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NormalizeNullDirection", "[", 
     RowBox[{
     "spacetime_SpacetimeObject", ",", " ", "pos_List", ",", " ", 
      "dir_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "metric", ",", " ", "coords", ",", " ", "g", ",", " ", "spatialDir", ",",
         " ", "timeComp", ",", "a", ",", "b", ",", "c", ",", "discriminant", ",",
         " ", "dtd\[Lambda]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"metric", " ", "=", " ", 
        RowBox[{
         RowBox[{"spacetime", "[", "\"\<Metric\>\"", "]"}], 
         "[", "\"\<Matrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"coords", " ", "=", " ", 
        RowBox[{"spacetime", "[", "\"\<Coordinates\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Get", " ", "metric", " ", "components", " ", "at", " ", "this", " ", 
         "position"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"metric", "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"coords", "->", "pos"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Extract", " ", "spatial", " ", "components", " ", "of", " ", 
         "direction", " ", 
         RowBox[{"(", 
          RowBox[{
          "assuming", " ", "time", " ", "is", " ", "first", " ", 
           "component"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"spatialDir", " ", "=", " ", 
        RowBox[{"dir", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"For", " ", "null", " ", 
          RowBox[{"geodesics", ":", 
           RowBox[{"g_\[Mu]\[Nu]", " ", 
            RowBox[{"v", "^", "\[Mu]"}], " ", 
            RowBox[{"v", "^", "\[Nu]"}]}]}]}], "=", "0"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"g_", "00", " ", 
           RowBox[{"(", 
            RowBox[{"dt", "/", "d\[Lambda]"}], ")"}], "\.b2"}], "+", 
          RowBox[{"2", " ", "g_", "0", "i", " ", 
           RowBox[{"(", 
            RowBox[{"dt", "/", "d\[Lambda]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx", "^", "i"}], "/", "d\[Lambda]"}], ")"}]}], "+", 
          RowBox[{"g_ij", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx", "^", "i"}], "/", "d\[Lambda]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx", "^", "j"}], "/", "d\[Lambda]"}], ")"}]}]}], "=", 
         "0"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"a", " ", "=", " ", 
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", " ", "=", " ", 
        RowBox[{"2", " ", "*", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "*", 
            RowBox[{"spatialDir", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", " ", 
              RowBox[{"j", "+", "1"}]}], "]"}], "]"}], " ", "*", " ", 
           RowBox[{"spatialDir", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "*", " ", 
           RowBox[{"spatialDir", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"discriminant", " ", "=", " ", 
        RowBox[{
         SuperscriptBox["b", "2"], "-", 
         RowBox[{"4", " ", "a", " ", "c"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Choose", " ", "positive", " ", "time", " ", "component", " ", "for", 
         " ", "forward", " ", "evolution"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dtd\[Lambda]", "=", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "a", "]"}], ">", 
           RowBox[{"10", "^", 
            RowBox[{"(", 
             RowBox[{"-", "12"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"Max", "[", 
               RowBox[{"0", ",", "discriminant"}], "]"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "a"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Linear", " ", "case", " ", "when", " ", "a"}], "\[TildeTilde]",
             "0"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"-", "c"}], "/", "b"}]}], "  ", "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Return", " ", "normalized", " ", "4"}], "-", "vector"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"dtd\[Lambda]", ",", 
         RowBox[{"Sequence", "@@", "spatialDir"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BuildGeodesicSystem", "[", 
     RowBox[{
     "spacetime_SpacetimeObject", ",", " ", "initialPos_List", ",", " ", 
      "initialDir_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "metric", ",", "coords", ",", " ", "coordFunctions", ",", " ", 
        "christoffel", ",", " ", "geodesicEqs", ",", " ", "initialConditions",
         ",", "\[Lambda]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coords", " ", "=", " ", 
        RowBox[{"spacetime", "[", "\"\<Coordinates\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coordFunctions", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", "\[Lambda]", "]"}], "&"}], ")"}], "/@", 
         "coords"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"christoffel", " ", "=", " ", 
        RowBox[{
         RowBox[{"spacetime", "[", "\"\<Christoffel\>\"", "]"}], 
         "[", "\"\<Matrix\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Build", " ", "the", " ", "geodesic", " ", 
          RowBox[{"equation", ":", 
           RowBox[{
            RowBox[{
             RowBox[{"d\.b2x", "^", "\[Mu]"}], "/", "d\[Lambda]\.b2"}], "+", 
            RowBox[{
             RowBox[{"\[CapitalGamma]", "^", "\[Mu]_\[Nu]\[Rho]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dx", "^", "\[Nu]"}], "/", "d\[Lambda]"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dx", "^", "\[Rho]"}], "/", "d\[Lambda]"}], 
              ")"}]}]}]}]}], "=", "0"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"geodesicEqs", " ", "=", " ", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"coordFunctions", "[", 
               RowBox[{"[", "\[Mu]", "]"}], "]"}], ",", " ", "\[Lambda]", ",",
               "\[Lambda]"}], "]"}], " ", "+", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"christoffel", "[", 
                RowBox[{"[", 
                 RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Rho]"}], "]"}], "]"}],
                " ", "*", " ", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"coordFunctions", "[", 
                  RowBox[{"[", "\[Nu]", "]"}], "]"}], ",", "\[Lambda]"}], 
                "]"}], "*", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"coordFunctions", "[", 
                  RowBox[{"[", "\[Rho]", "]"}], "]"}], ",", "\[Lambda]"}], 
                "]"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"\[Nu]", ",", "1", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Rho]", ",", "1", ",", "4"}], "}"}]}], "]"}]}], " ", 
           "==", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"initialConditions", " ", "=", " ", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"coords", "==", "initialPos"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"coordFunctions", ",", "\[Lambda]"}], "]"}], "==", 
            "initialDir"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"geodesicEqs", ",", " ", "initialConditions"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Geodesic", " ", "Solution", " ", "Object"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Object", " ", "to", " ", "hold", " ", "geodesic", " ", "solution"}], 
    "*)"}], 
   RowBox[{
    RowBox[{"GeodesicSolution", "[", 
     RowBox[{"solution_List", ",", "coords_List", ",", "paramRange_List"}], 
     "]"}], ":=", 
    RowBox[{"GeodesicSolutionObject", "[", 
     RowBox[{"solution", ",", "coords", ",", "paramRange"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Methods", " ", "for", " ", "GeodesicSolution"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"GeodesicSolutionObject", "[", 
       RowBox[{"sol_", ",", "coords_", ",", "range_"}], "]"}], "[", 
      "method_String", "]"}], ":=", 
     RowBox[{"Switch", "[", 
      RowBox[{"method", ",", "\[IndentingNewLine]", "\"\<Position\>\"", ",", 
       RowBox[{"Function", "[", 
        RowBox[{"\[Lambda]", ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"coords", "/.", " ", "sol"}], "/.", " ", 
           RowBox[{"\[Lambda]", "->", "#"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\"\<Velocity\>\"", ",", 
       RowBox[{"Function", "[", 
        RowBox[{"\[Lambda]", ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Through", "[", 
             RowBox[{
              RowBox[{"coords", "'"}], "[", "\[Lambda]", "]"}], "]"}], "/.", 
            " ", "sol"}], "/.", " ", 
           RowBox[{"\[Lambda]", "->", "#"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\"\<ParameterRange\>\"", ",", "range", ",", 
       "\[IndentingNewLine]", "\"\<Plot\>\"", ",", 
       RowBox[{"GeodesicPlot", "[", 
        RowBox[{"GeodesicSolutionObject", "[", 
         RowBox[{"sol", ",", "coords", ",", "range"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "\"\<PlotPath\>\"", ",", 
       RowBox[{"GeodesicPathPlot", "[", 
        RowBox[{"GeodesicSolutionObject", "[", 
         RowBox[{"sol", ",", "coords", ",", "range"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "\"\<Coordinates\>\"", ",", "coords", ",", 
       "\[IndentingNewLine]", "\"\<Solution\>\"", ",", "sol", ",", 
       "\[IndentingNewLine]", "_", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"GeodesicSolution", "::", "method"}], ",", "method"}], 
          "]"}], ";", "$Failed"}], ")"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GeodesicSolution", "::", "method"}], 
     "=", "\"\<Unknown method `1`. Available: Position, Velocity, \
ParameterRange, Plot, PlotPath\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Formatting", " ", "for", " ", "GeodesicSolution"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"GeodesicSolutionObject", "/:", 
    RowBox[{"Format", "[", 
     RowBox[{"GeodesicSolutionObject", "[", 
      RowBox[{"sol_", ",", "coords_", ",", "range_"}], "]"}], "]"}], ":=", 
    RowBox[{"DisplayForm", "@", 
     RowBox[{"Panel", "[", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<GeodesicSolution\>\"", ",", "\"\<[\>\"", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"Length", "[", "coords", "]"}], "]"}], 
          ",", "\"\<D, \[Lambda]\[Element]\>\"", ",", 
          RowBox[{"ToBoxes", "[", "range", "]"}], ",", "\"\<]\>\""}], "}"}], 
        "]"}], ",", 
       RowBox[{"Background", "->", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.95", ",", "1", ",", "0.95", ",", ".3"}], "]"}]}], ",", 
       RowBox[{"FrameMargins", "->", "3"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GeodesicPlot", "[", "geodSol_GeodesicSolutionObject", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coords", ",", "range", ",", "posFunc", ",", "plots"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"coords", "=", 
        RowBox[{"geodSol", "[", "\"\<Coordinates\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"geodSol", "[", "\"\<ParameterRange\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"posFunc", "=", 
        RowBox[{"geodSol", "[", "\"\<Position\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Plot", " ", "each", " ", "coordinate", " ", "vs", " ", "affine", " ",
          "parameter"}], "*)"}], 
       RowBox[{"plots", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"posFunc", "[", "\[Lambda]", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]", ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"range", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"PlotLabel", "->", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"coords", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], 
              "<>", "\"\<[\[Lambda]]\>\""}]}], ",", 
            RowBox[{"Frame", "->", "True"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"GraphicsGrid", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"plots", ",", "2"}], "]"}], ",", 
         RowBox[{"Frame", "->", "All"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"GeodesicPathPlot", "[", "geodSol_GeodesicSolutionObject", "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coords", ",", "range", ",", "posFunc", ",", "spatialPath"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"coords", "=", 
        RowBox[{"geodSol", "[", "\"\<Coordinates\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"geodSol", "[", "\"\<ParameterRange\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"posFunc", "=", 
        RowBox[{"geodSol", "[", "\"\<Position\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "spatial", " ", "coordinates", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"assuming", " ", "t"}], ",", "x", ",", "y", ",", 
           RowBox[{"z", " ", "order"}]}], ")"}]}], "*)"}], 
       RowBox[{"spatialPath", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"posFunc", "[", "\[Lambda]", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", "4"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]", ",", 
            RowBox[{"range", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"range", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"range", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "100"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "3", "D", " ", "plot", " ", "of", " ", "spatial", " ", "path"}], 
        "*)"}], 
       RowBox[{"ListPointPlot3D", "[", 
        RowBox[{"spatialPath", ",", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"PointSize", "[", "0.01", "]"}]}], "}"}]}], ",", 
         RowBox[{"Joined", "->", "True"}], ",", 
         RowBox[{"AxesLabel", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"coords", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"coords", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"coords", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "->", "\"\<Null Geodesic Path\>\""}], ",", 
         RowBox[{"BoxRatios", "->", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", 
     RowBox[{"==", 
      RowBox[{"CONVENIENCE", " ", "FUNCTIONS"}]}], "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
     "=="}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Quick", " ", "light", " ", "ray", " ", "tracer", " ", "from", " ", 
     "camera", " ", "to", " ", "scene"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TraceLightRay", "[", 
     RowBox[{
     "spacetime_SpacetimeObject", ",", "cameraPos_List", ",", "pixelDir_List",
       ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "TraceNullGeodesic", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"geodSol", ",", "finalPos", ",", "rayPath"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Trace", " ", "the", " ", "null", " ", "geodesic"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"geodSol", "=", 
        RowBox[{"TraceNullGeodesic", "[", 
         RowBox[{
         "spacetime", ",", "cameraPos", ",", "pixelDir", ",", "opts"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "useful", " ", "information"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rayPath", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"geodSol", "[", "\"\<Position\>\"", "]"}], "[", 
           "\[Lambda]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]", ",", "0", ",", 
            RowBox[{
             RowBox[{"geodSol", "[", "\"\<ParameterRange\>\"", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<GeodesicSolution\>\"", "->", "geodSol"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<RayPath\>\"", "->", "rayPath"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<FinalPosition\>\"", "->", 
          RowBox[{
           RowBox[{"geodSol", "[", "\"\<Position\>\"", "]"}], "[", 
           RowBox[{
            RowBox[{"geodSol", "[", "\"\<ParameterRange\>\"", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<InitialPosition\>\"", "->", "cameraPos"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<InitialDirection\>\"", "->", "pixelDir"}]}], 
        "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Test", " ", "null", " ", "condition", " ", "along", " ", "geodesic"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"VerifyNullCondition", "[", 
     RowBox[{
     "spacetime_SpacetimeObject", ",", "geodSol_GeodesicSolutionObject"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "metric", ",", "coords", ",", "posFunc", ",", "velFunc", ",", "range", 
        ",", "samples", ",", "nullValues"}], "}"}], ",", 
      RowBox[{
       RowBox[{"metric", "=", 
        RowBox[{"spacetime", "[", "\"\<Matrix\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coords", "=", 
        RowBox[{"spacetime", "[", "\"\<Coordinates\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"posFunc", "=", 
        RowBox[{"geodSol", "[", "\"\<Position\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"velFunc", "=", 
        RowBox[{"geodSol", "[", "\"\<Velocity\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"geodSol", "[", "\"\<ParameterRange\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Sample", " ", "along", " ", "geodesic"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"samples", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"\[Lambda]", ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]", ",", 
            RowBox[{"range", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"range", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"range", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"range", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "20"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Calculate", " ", "g_\[Mu]\[Nu]", " ", 
         RowBox[{"v", "^", "\[Mu]"}], " ", 
         RowBox[{"v", "^", "\[Nu]"}], " ", "at", " ", "each", " ", "point"}], 
        "*)"}], 
       RowBox[{"nullValues", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"pos", "=", 
               RowBox[{"posFunc", "[", "\[Lambda]", "]"}]}], ",", 
              RowBox[{"vel", "=", 
               RowBox[{"velFunc", "[", "\[Lambda]", "]"}]}]}], "}"}], ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"metric", "[", 
                  RowBox[{"[", 
                   RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "]"}], "/.", " ", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"coords", "->", "pos"}], "]"}]}], ")"}], "*", 
               RowBox[{"vel", "[", 
                RowBox[{"[", "\[Mu]", "]"}], "]"}], "*", 
               RowBox[{"vel", "[", 
                RowBox[{"[", "\[Nu]", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "1", ",", "4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Nu]", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]", ",", "samples"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Plot", " ", "null", " ", "condition", " ", "violation"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"samples", ",", "nullValues"}], "}"}], "]"}], ",", 
         RowBox[{
         "PlotLabel", 
          "->", "\"\<Null Condition: g_\[Mu]\[Nu] v^\[Mu] v^\[Nu]\>\""}], ",", 
         RowBox[{"AxesLabel", "->", 
          RowBox[{"{", 
           
           RowBox[{"\"\<Affine Parameter \[Lambda]\>\"", 
            ",", "\"\<g_\[Mu]\[Nu] v^\[Mu] v^\[Nu]\>\""}], "}"}]}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"GridLines", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.964991851390273*^9, 3.9649922551047907`*^9}, {
   3.964992306286295*^9, 3.964992420223372*^9}, {3.9649924669214067`*^9, 
   3.9649925514965477`*^9}, {3.964992667880662*^9, 3.9649927736729527`*^9}, {
   3.9649944509122*^9, 3.964994451701479*^9}, {3.964994692140601*^9, 
   3.964994730331378*^9}, {3.964994778814184*^9, 3.96499492967671*^9}, {
   3.9649949723543177`*^9, 3.964994985163232*^9}, {3.9649950657923403`*^9, 
   3.964995066483027*^9}, {3.9649953719558077`*^9, 3.9649953724736023`*^9}, {
   3.9649954407829103`*^9, 3.9649954488587227`*^9}, {3.964995547130406*^9, 
   3.964995549092918*^9}, {3.964996092354179*^9, 3.964996130648525*^9}, {
   3.964996176489423*^9, 3.9649962045644608`*^9}, 3.96499626883171*^9, {
   3.964996301135638*^9, 3.964996410327836*^9}},
 CellLabel->
  "In[1476]:=",ExpressionUUID->"7693e903-a355-46b0-9bc4-e014cd73f9d4"]
},
WindowSize->{1440, 792},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"14.2 for Linux x86 (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e1b92dbb-c61e-4221-b519-12d497350759"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 346, 8, 36, "Input",ExpressionUUID->"f9621b7f-6184-4bda-81b5-d883d9e89c5f"],
Cell[903, 30, 28379, 664, 5148, "Input",ExpressionUUID->"46cb78d0-645c-41ba-9671-f0357470e829"],
Cell[29285, 696, 32244, 759, 5711, "Input",ExpressionUUID->"7693e903-a355-46b0-9bc4-e014cd73f9d4"]
}
]
*)

